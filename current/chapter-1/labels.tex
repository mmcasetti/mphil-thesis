\section{Bimatrix Games and Labels}

In the rest of this thesis we will focus bimatrix games.
We will assume that the payoff matrices $(A,B)$ are non-negative,
and that neither $A$ nor $B\T$ has a zero column, if necessary applying
an affine transformation, which does not affect the equilibria of the game.

The Nash equilibria of bimatrix games can be analysed from a combinatorial
point of view using {\em labels}. This method is due to Shapley
\cite{shapley}, in a study building on ideas introduced in a
paper by Lemke and Howson \cite{lh}.
Let $n,m\in\naturals$ with $m\leq n$, and consider a set $X$ with $|X|=n$.
A {\em labeling} of $X$ is a function $l:X\to [m]$. An $m$-uple
$x=(x_1,\ldots,x_m)\in X^m$ is {\em completely labeled} if
$\{ i\in [m]\ |\ l(x_j)=i\text{ for some }j\in [m] \}=[m]$, that is, if
each label $j\in [m]$ appears once and only once in $(l(x_1),\ldots,l(x_m))$.

Let $(A,B)$ be bimatrix game, and let $X$ and $Y$ be the mixed strategy
simplices of respectively player 1 and 2; that is
\begin{equation}\label{mixed-strat-simplices}
X = \{ x\in\reals^m\ |\ x\geq\0,\ \1\T x = 1 \};\quad
Y = \{ y\in\reals^n\ |\ y\geq\0,\ \1\T y = 1 \}.
\end{equation}

A {\em labeling} of the game is then given as follows:

\begin{enumerate}
\item the $m$ pure strategies of player 1 are identified by $1,\ldots,m$;
\item the $n$ pure strategies of player 2 are identified by $m+1,\ldots,m+n$;
\item each mixed strategy $x\in X$ of player 1 has
    \begin{itemize}
    \item label $i$ for each $i\in [m]$ such that $x_i = 0$, that is if in
    $x$ player 1 does not play her $i$th pure strategy,
    \item label $m + j$ for each $j\in [n]$ such that the $j$th pure strategy
    of player 2 is a best response to $x$;
    \end{itemize}
\item each mixed strategy $y\in Y$ of player 2 has
    \begin{itemize}
    \item label $m + j$ for each $j\in [n]$ such that $y_j = 0$, that is if in
    $y$ player 2 does not play his $j$th pure strategy,
    \item label $i$ for each $i\in [m]$ such that the $i$th pure strategy
    of player 1 is a best response to $y$.
    \end{itemize}
\end{enumerate}

The labeling of mixed strategy profiles can be used to characterize the
Nash equilibria of the game.

\begin{theorem}{\rm (Shapley \cite{shapley})}\label{comp-label-thm}
Let $(x,y)\in X\times Y$; then $(x,y)$ is a Nash equilibrium of the bimatrix
game $(A,B)$ if and only if $(x,y)$ is completely labeled.

\begin{proof}
The mixed strategy $x\in X$ has label $m + j$ for some $j\in [n]$ if and
only if the $j$th pure strategy of player 2 is a best response to $x$; this,
in turn, is a necessary and sufficient condition for player 2 to play his
$j$th strategy at an equilibrium against $x$. Therefore, at an equilibrium
$(x,y)$ all labels $m + 1,\ldots,m + n$ will appear either as labels of
$x$ or of $y$. The analogous holds for the labels $i\in [n]$.
\end{proof}
\end{theorem}

An useful graphical representation of labels on the simplices $X$ and $Y$.
is done by labeling the outside of each simplex according to the player's own
pure strategies that are {\em not} played, and by subdividing its interior
in closed polyhedral sets corresponding to the other player's best response,
called {\em best response regions}. We give an example of this construction.

\begin{example}
\label{br-game-ex}
Consider the $3\times 3$ game $(A,B)$ with
\begin{equation}
\label{AB}
A = \left(\begin{matrix}1&0&0\\ 0&1&0\\
0&0&1\end{matrix}\right),
\qquad
B = \left(\begin{matrix}0&2&4\\ 3&2&0\\
0&2&0\end{matrix}\right).
\end{equation}

The pure strategies of player~1 are labeled as $1,2,3$; the pure strategies
of player~2 are labeled as $4,5,6$.

In the following figures the labels of the strategies will be represented
as circled numbers.
Figure~\ref{br-regions-fig} shows $X$ and $Y$: the exterior is labeled with the
player's own pure strategies where these are not played, so the facet
labeled with a pure strategy is opposite to the vertex where only that pure
strategy is played; the interior is covered by the best response regions,
with labels corresponding to the other player's pure strategies that are in
the best response to the player's own strategy in the region.
For example, the best-response region in $Y$ with label~$1$
is the set of those $(y_1,y_2,y_3)$ so that $y_1\ge y_2$ and
$y_1\ge y_3$.
There is only one pair $(x,y)$
that is completely labeled, namely $x=(\frac13,\frac23,0)$
with labels $3,4,5$ and $y=(\frac12,\frac12,0)$ with labels
$1,2,6$, so this is the only Nash equilibrium of the game.

\begin{figure}[hbt]
\strut\hfill
\includegraphics[width=27ex]{chapter-1/fig/Xnondeg.pdf}%
\hfill
%\vrule height 52mm ~ \vrule height 27ex
\hfill
\includegraphics[width=27ex]{chapter-1/fig/Yimit.pdf}%
\hfill\strut
\caption{%
Labeled mixed strategy sets $X$ and $Y$ for the game (\ref{AB}).
}
\label{br-regions-fig}
\end{figure}

\end{example}

The point of view of best response regions can be translated to an equivalent
construction of {\em best response polytopes}.
We begin by noticing that the best-response regions can be obtained as
projections on $X$ and $Y$ of the {\em best-response facets} of
the polyhedra
\begin{equation}\label{br-polyhedron}
\bar{P} = \{ (x,v)\in X\times\reals\ |\ B\T x\leq\1 v \};\quad
\bar{Q} = \{ (y,u)\in Y\times\reals\ |\ A y\leq\1 u \}.
\end{equation}

These facets in $\bar{P}$ are defined as the points $(x,v)\in X\times\reals$
such that $(B\T x)_j = v$, which in turn represent the strategies $x\in X$ of
player 1 that give exactly payoff $v$ to player 2 when he plays strategy $j$;
the projection of the facet defined by $(B\T x)_j = v$ to $X$ has then
label $j$. Analogously, the facet of $\bar{Q}$ given by the points
$(y,u)\in Y\times\reals$ such that $(A y)_i = u$ will project to the
best-response region of $Y$ with label $i$.

\begin{example}
In the example \ref{br-game-ex}, the inequalities $B\T x\le\1v$ state
$3x_2\leq v$, $2x_1+2x_2+2x_3\leq v$, $4x_1\leq v$.
Figure~\ref{br-polyhedron-fig} shows the best-response facets of $\bar{P}$ and
their projection to $X$ by ignoring the payoff variable~$v$, which
gives the subdivision of $X$ into best-response regions Figure
\ref{br-regions-fig}.

\begin{figure}[hbt]
\strut\hfill
\includegraphics[height=40mm]{chapter-1/fig/upenv.pdf}%
\hfill\strut
\caption{%
Best response facets of the polyhedron $\bar{P}$ in (\ref{br-polyhedron}).
}
\label{br-polyhedron-fig}
\end{figure}
\end{example}

Given the assumptions on non-negativity of $A$ and $B\T$, we can give a
change coordinates to $x_i / v$ and $y_j / u$ and replace $\bar{P}$ and
$\bar{Q}$ with the {\em best-response polytopes}
\begin{equation}\label{br-polytopes}
P = \{ x\in\reals^m\ |\ x\geq\0,\ B\T x\leq\1 \};\quad
Q = \{ y\in\reals^n\ |\ y\geq\0,\ A y\leq\1 \}.
\end{equation}

The polytope $P$ is the intersection of $n+m$ half spaces, one for each
inequality corresponding to either player 1 avoiding her $i$-th pure
strategy, where $i\in [m]$, or to a best response of player 2 that gives
non-zero probability to his $j$-th strategy, where $j\in [n]$.
Formally, a point $x\in P$ has label $k$ if and only if either
$x_k = 0$ for $k\in [m]$ or $(B\T x)_k = 0$ for $k\in [n]$.
Analogously, a point in $Q$ has label $k$ if and only if either
$y_k = 0$ for $k\in [n]$ or $(A y)_k$ for $k\in [m]$.
Then a point $(x,y)\in P\times Q$ is completely labeled if and only if
it satisfies the {\em complementarity condition}
\begin{eqnarray}
x_i = 0\text{ or }(Ay)_i = 1\text{ for all }i\in [m];\nonumber \\
y_j = 0\text{ or }(B\T x)_j\text{ for all }j\in [n].
\end{eqnarray}
Then either he point corresponding to $(x,y)$ in $\bar{P}\times\bar{Q}$
is a Nash equilibrium, or $(x,y)=(\0,\0)$; we will refer to the latter case
as {\em artificial equilibrium}.

\begin{example}
Keeping on with example \ref{br-game-ex}, the polyhedron $\bar{P}$ of
Figure \ref{br-polyhedron-fig} becomes the polytope in Figure \ref{br-polytopes-fig}
\ref{br-polytopes-fig}.

\begin{figure}[hp]
\includegraphics[height=50mm]{chapter-1/fig/polytope.pdf}%
\caption{%
Best response polytope $P$ in (\ref{br-polytopes}) for the game in (\ref{AB}).
}
\label{br-polytopes-fig}
\end{figure}

Note that the vertex $(\0,\0)$ has labels $1,2,3$ in $P$ and, analogously,
it has labels $4,5,6$ in $Q$, so it is completely labeled, and corresponds
to the ``artificial'' equilibrium.
\end{example}

\todo[inline]{

nondegeneracy.

in the following: equilibria are on vertices, not simply points

$P$ is simple, so later $P^\Delta$ is simplicial.

``lexicographic'' perurbation makes it non-degenerate (see AB).

ex pg 9 SvS-15

From now on, we assume nondegeneracy.
}

The characterization of Nash equilibria as completely
labeled pairs $(x,y)$ holds for arbitrary bimatrix games.
For considering algorithms, it is useful to assume that the
game is \emph{non\-degen\-erate} in the sense that no point in
$P$ has more than $m$ labels, and no point in $Q$ has more
than $n$ labels.
Clearly, for a non\-degen\-erate game, in an equilibrium
$(x,y)$ each label appears exactly once either as a label of
$x$ or of~$y$.

Nondegeneracy is equivalent to the condition that the
number of pure best responses against a mixed strategy is never
larger than the size of the support of that mixed strategy.
It implies that $P$ is a \emph{simple} polytope in the sense
that no point of $P$ lies on more than $m$ \emph{facets},
and similarly that $Q$ is a simple polytope.
A facet is obtained by turning one of the inequalities
that define the polytope into an equality, provided the
inequality is irredundant, that is, cannot be omitted
without changing the polytope.
A redundant inequality in the definition of $P$ and $Q$ may
also give raise to a degeneracy if it corresponds to a pure
strategy that is weakly (but not strictly) dominated by, or
payoff equivalent to, a mixture of other strategies.
For a detailed discussion of degeneracy see von Stengel
(2002).

\todo[inline]{end: degeneracy}

We will now consider a particular class of games, called
{\em unit vector games}. These are games of the form $(U,B)$,
where the columns of the matrix $U$ are unit vectors.
We will see that a method that ``solves'' a unit vector game, in the sense
of finding one equilibrium, or all equilibria, of the game, can be used to
solve any arbitrary bimatrix game.
First of all, we note that any bimatrix game can be ``symmetrized.''
The result is due to Gale, Kuhn and Tucker \cite{gale-kuhn-tucker} for
zero-sum games; its extension to non-zero-sum games is a folklore result.

\begin{proposition}\label{symmetrize-thm}
Let $(A,B)$ be a bimatrix game and $(x,y)$ be one of its Nash equilibria.
Then $(z,z)$, where $z=(x,y)$, is a Nash equilibrium of the symmetric game
$(C,C\T)$, where
\begin{equation}
C = \left(
    \begin{array}{cc}
    0 & A \\
    B\T & 0
    \end{array}
    \right).
\end{equation}
\end{proposition}

McLennan and Tourky \cite{mclennan-tourky} have proven a converse of
proposition \ref{symmetrize-thm} for bimatrix games of the form $(I,B)$,
called {\em imitiation games}.

\begin{theorem}{\rm (McLennan and Tourky \cite{mclennan-tourky})}
\label{imitation-thm}
The pair $(x,x)$ is a symmetric Nash equilibrium of the symmetric bimatrix
game $(C,C\T)$ if and only if there is some $y$ such that $(x,y)$ is a
Nash equilibrium of the imitation game $(I,B)$ with $B=C\T$.
\end{theorem}

By theorem \ref{imitation-thm},
the mixed strategy $x$ of player 1 in any Nash equilibrium of the imitation
game $(I,B)$ corresponds exactly to the symmetric equilibrium $(x,x)$ of
the symmetric game defined by the payoff matrix of the other player.
Therefore, an algorithm that finds a Nash equilibrium of a bimatrix game
can be used to find a symmetric Nash equilibrium of a symmetric game.

\begin{example}
As an example, consider the symmetric game $(C,C\T)$ with
\begin{equation}
\label{C}
C = \left(\begin{matrix}0&3&0\\ 2&2&2\\
4&0&0\end{matrix}\right),
\qquad
C\T = \left(\begin{matrix}0&2&4\\ 3&2&0\\
0&2&0\end{matrix}\right),
\end{equation}
so that $C\T=B$ in (\ref{AB}), and the corresponding imitation game
$(I,C\T)$ is $(A,B)$ in (\ref{AB}).

Figure~\ref{imit-fig} shows the labeled mixed-strategy simplices $X$ and $Y$
for the game \ref{C}; since the game is symmetric, only the labels
are different.
In addition to the symmetric equilibrium $(x,x)$ where
$x=(\frac13,\frac23,0)$, the game has two non-symmetric equilibria in $(a,b)$
and $(b,a)$ with $a=(\frac12,\frac12,0)$ and $b=(0,\frac23,\frac13)$.

Note that the corresponding imitation game $(A,B)$ has only one
equilibrium in $(x,y)$, where $(x,x)$ is the symmetric equilibrium of
$(C,C\T)$.
This shows how theorem \ref{imitation-thm} applies to the {\em symmetric}
equilibria of the symmetric game, but not to all its equilibria; there
could be non-symmetric equilibria of $(C,C\T)$ that are not found
through the imitation game.

\begin{figure}[hbt]
\strut\hfill
\includegraphics[width=27ex]{chapter-1/fig/Xnondeg.pdf}%
\hfill
\hfill
\includegraphics[width=27ex]{chapter-1/fig/Ynondeg.pdf}%
\hfill\strut
\caption{%
Best response regions for the symmetric game $(C,C\T)$ in (\ref{C}).
}
\label{imit-fig}
\end{figure}
\end{example}

The correspondence between equilibria of a unit vector game
and completely labeled points
\todo{also in thm: vertices, if nondeg}
of a polytope is given by the following
theorem, first proved in dual form by Balthasar \cite{balthasar} and
given here as in Savani and von Stengel \cite{uvg}.

\begin{theorem}{\rm (Savani and von Stengel \cite{uvg})}\cite{uvg}
\label{unit-vector-thm}
Let $l:[n]\to [m]$, and let $(U,B)$ be the unit vector game where
$U=(e_{l(1)}\ \cdots\ e_{l(n)})$. Let $N_i = \{ j\in [n]\ |\ l(j)=i \}$ for
$i\in [m]$, and consider the polytopes $P^l$ and $Q^l$
\begin{eqnarray}
P^l = \{ x\in\reals^m\ |\ x\geq\0,\ B\T x\leq\1 \}; \label{p-l} \\
Q^l = \{ y\in\reals^n\ |\ y\geq\0,\
\sum_{\substack{j\in N_i \\ i\in [m]}} y_j\leq 1 \}. \label{q-l}
\end{eqnarray}

Let $l_f$ be the labeling of the facets of $P^l$ defined as follows:
\begin{eqnarray}\label{facet-labeling-unitv}
x_i\geq 0\text{ has label }i\text{ for }i\in [m]; \nonumber \\
(B\T x)_j \leq 1\text{ has label }l(j)\text{ for }j\in [n].
\end{eqnarray}

Then $x\in P^l$ is a completely labeled point
\todo{vertex}
of $P^l\setminus\{\0\}$
if and only if there is some $y\in Q^l$ such that, after scaling,
the pair $(x,y)$ is a Nash equilibrium of $(U,B)$

\begin{proof}
\todo{check}
Let $P,Q$ be the polytopes associated to the game $(U,B)$ as before.

Let $(x,y)\in P\times Q\setminus\{ \0,\0 \}$ be a Nash equilibrium of
$(U,B)$, therefore completely labeled in $[m + n]$.
Then, if $x_i=0$, then $x$ has label $i\in m$.
If $x_i > 0$ instead, then $y$ has label $i$, therefore $(Uy)_i = 1$,
therefore for some $j\in [n]$ we have $y_j > 0$ and $U_j = e_i$, so $l(j)=i$.
Since $y_j > 0$ and $(x,y)$ is completely labeled, $x\in P$ has label $m+j$,
that is, $(B\T x)_j = 1$, therefore $x\in P^l$ has label $l(j) = i$.
Hence, $x$ is a completely labeled point of $P^l$.

Conversely, let $x\in P^l\setminus \{ \0 \}$ be completely labeled.
If $x_i > 0$, then there is $j\in [m]$ such that $(B\T x) = j$ and
$l(j) = i$, that is, $j\in N_i$. For all $i$ such that $x_i >0 $,
define $y$ as follows: $y_h = 0$ for all $h\in N_i\setminus \{ j \}$,
$y_j = 1$. Then $(x,y)\in P\times Q$ is completely labeled.
\end{proof}
\end{theorem}

\begin{example}
The game in example \ref{br-game-ex} is a unit vector game, with $l(i)=i$.
In figure \ref{br-polytopes-fig} we have the labels $4,5,6$ on the best
response facets of polytope $P$; the facets with labels $1,2,3$, that is,
the facets where $x_1=0$, $x_2=0$, $x_3=0$, respectively, are at
back right, back left, and bottom of the polytope.
In the polytope $P^l$ the labels $4,5,6$ are replaced by $1,2,3$ because
the corresponding columns of $A$ are the unit vectors $e_1,e_2,e_3$.
Figure~\ref{p-l-fig} shows the polytope $P^l$; the only hidden facet,
with label~$1$, is at the bottom.
Apart from the origin $\0$, the only completely labeled
point of $P^l$ is $x$, as shown in figure \ref{p-l-fig}.

\begin{figure}[hbt]
\strut\hfill
\includegraphics[width=27ex]{chapter-1/fig/p-l-color.pdf}%
\hfill\strut
\caption{%
The polytope $P^l$ for the unit vector game (\ref{AB}).
The hidden facet at the back has label~$1$.
}
\label{p-l-fig}
\end{figure}
\end{example}

Theorem \ref{unit-vector-thm} gives a correspondence between the
completely labeled vertices of the polytope $P^l$ and the equilibria
of the unit vector game $(U,B)$, with an ``artificial''
equilibrium corresponding to the vertex $\0$. We will now construct its dual
version given in \cite{balthasar}.
We traslate the polytope $P^l$ as in \ref{p-l} to
$P = \{ x - \1\ |\ x\in P^l \}$, and multiply all payoffs in $B$ by a
constant, if necessary, so that $\0$ is in the interior of $P$.
We have that
\begin{align*}
P & = \{ x + \1\geq\0,\ (x + \1)\T B\leq\1 \} = \\
  & = \{ x\in\reals^m\ |\ -x_i\leq 1\text{ for }i\in [m],\
    x\T (b_j/(1 - \1\T b_j)) \leq 1\text{ for }j\in [n] \}.
\end{align*}
The polar of $P$ is then
\begin{equation}\label{p-l-dual}
P^\Delta = \conv(\{−e_i\ |\ i\in [m] \}\ \cup\ \{ \frac{b_j}{1 - \1\T b_j} \})
\end{equation}

Since $P$ is a simple polytope with $\0$ in its interior, $P^\Delta$ is
simplicial, $P^{\Delta\Delta}=P$, and the facets of $P^\Delta$ correspond to
the vertices of $P$ and vice versa. We can then label the vertices
of $P^\Delta$ as the corresponding facets in $P^l$; the completely
labeled facets of $P^\Delta$ will then correspond to the completely
labeled vertices of $P^l$.
In particular, the facet corresponding to $\0$ will be
\begin{equation}\label{f-0}
F_0 = \{ x\in P^\Delta\ |\ -\1\T x = 1 \} = \conv\{ e_i\ |\ i\in [m] \}.
\end{equation}
Theorem \ref{unit-vector-thm} then translates as in the original version
by Balthasar \cite{balthasar}.

\begin{theorem}{\rm (Balthasar \cite{balthasar})}\label{unit-vector-dual-thm}
Let $Q$ be a labeled $m$-dimensional simplicial polytope with \0 in
its interior and vertices $e_1,\ldots,e_m,c_1,\ldots,c_n$ such that
$F_0 = \conv\{ e_i\ |\ i\in [m] \}$ is a facet of $Q$.
Let $(U,B)$ be a unit vector game, with $U=(e_{l(1)}\ \cdots\ e_{l(n)})$
for a labeling $l:[n]\to [m]$ and $B = (b_1\ \cdots\ b_n)$ with
$b_j = c_j/(1 + \1\T c_j)$ for $j\in [n]$. Let $l_v$ be a labeling
of the vertices of $Q$ as follows:
\begin{eqnarray}\label{vert-labeling-unitv}
l_v(-e_i)=i\text{ for }i\in [m]; \nonumber \\
l_v(c_j)=l(j)\text{ for }j\in [n].
\end{eqnarray}

Then a facet $F\neq F_0$ of $Q$ with normal vector $v$ is completely
labeled if and only if $(x,y)$ is a Nash equilibrium of $(U,B)$, where
$x = (v + \1) / (\1\T (v + \1))$
\todo{??? here to end thm}
,
and $x_i = 0$ if and only if $−e_i\in F$ for $i\in [m]$.
Any $j$ so that $c_j$ is a vertex of $F$ represents a pure best reply to $x$;
the mixed strategy $y$ is the uniform distribution on the set of the pure best
replies to $x$.
\end{theorem}

As in theorem \ref{unit-vector-thm} we have a correspondence between
completely labeled vertices of $P^l$ and equilibria of the unit vector game
$(U,B)$ with an ``artificial'' equilibrium corresponding to the vertex $\0$,
in theorem \ref{unit-vector-dual-thm} we have a correspondence between
the completely labeled facets of the polytope $Q$
and the equilibria of the unit vector game $(U,B)$
with the ``artificial'' equilibrium corresponding to the
facet $F_0$.

\todo[inline]{prove polynomial encoding - therefore poly reduction

edit from here}

Consider now the problems

\begin{fctproblem}
{Another Completely Labeled Vertex}
{A simple $m$-dimensional polytope $S$ with $m+n$ facets;
a labeling $l_f:[m+n]\to [n]$;
a facet $F_0$ of $S$, completely labeled by $l_f$.}
{A facet $F\neq F_0$ of $S$, completely labeled by $l$.}
\end{fctproblem}

\begin{fctproblem}
{Another Completely Labeled Facet}
{A simplicial $m$-dimensional polytope $S$ with $m+n$ vertices;
a labeling $l_v:[m+n]\to [n]$;
a facet $F_0$ of $S$, completely labeled by $l_v$.}
{A facet $F\neq F_0$ of $S$ completely labeled by $l_v$.}
\end{fctproblem}

\begin{fctproblem}
{Unit Vector Nash}
{A unit vector game $\Gamma$.}
{A Nash equilibrium of $\Gamma$.}
\end{fctproblem}

\begin{proposition}\label{ne-cl-pbl}
The problem {\sc Unit Vector Nash} is
polynomial-time reducible to the problems
{\sc Another Completely Labeled Vertex} and its dual
{\sc Another Completely Labeled Facet}.
\end{proposition}

\todo[inline]{in general, 2-NASH, since we can go back to 2 polytopes - see LH}

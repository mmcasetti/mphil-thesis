\section{Cyclic Polytopes and Gale Strings}

In theorems \ref{unit-vector-thm} and \ref{unit-vector-dual-thm} we have
built a correspondence between labeled polytopes and unit vector games,
where Nash equilibria correspond to completely labeled vertices or facets.
We now focus on a particular kind of simplicial polytopes, called
{\em cyclic polytopes}, that can be represented as a combinatorial structure,
the {\em Gale strings}. We will first give the definition of cyclic polytope,
then of Gale string, then the theorem by Gale \cite{gale} about their
correspondence.

The {\em moment curve} in dimension $d$ is defined as
\begin{equation}
\mu_d:\reals\longrightarrow\reals^d,\quad
\mu_d:t\longmapsto (t,t^2,\ldots,t^d)\T .
\end{equation}
The {\em cyclic polytope} in dimension~$d$ with $n$ vertices, where $n>d$ is
\begin{equation}
C_d(n)=\conv\{ \mu_d(t_i)\ |\ t_1<\ldots<t_n\text{ affinely independent } \}.
\end{equation}

\begin{example}
\label{cyc36-ex}
The cyclic polytope in dimension 3 with 6 facets can be seen in figure
\ref{cyc36-fig}.

\begin{figure}[hbt]
\strut\hfill
\includegraphics[width=35ex]{chapter-1/fig/cyc36.pdf}
\hfill\strut
\caption{The cyclic polytope $C_3(6)$
}
\label{cyc36-fig}
\end{figure}
\end{example}

Given $k\in\naturals$ and a set $S$, we can represent the function
$f:[k]\to S$ as the string $s=s(1)s(2)\cdots s(k)$; we have a {\em bitstring}
if $S=\{0,\1\}$. A maximal substring of consecutive
\1's in a bitstring is called a {\em run}; an {\em interior} run is
bounded on both sides by 0's. We will use the notation $\1^k$ for a
run of length $k$, and $0^k$ for a string of 0's of length $k$
A {\em Gale string of length $n$ and dimension $d$}, where $n>d$, is
a bitstring $s\in G(d,n)$ satisfying the following conditions:
\begin{enumerate}
\item exactly $d$ bits in $s$ are $\1$ and
\item ({\em Gale evenness condition})
\begin{equation}
0\1^k0\text{ is a substring of }s\quad
{\Longrightarrow}\quad
k\text{ is even.}
\end{equation}
\end{enumerate}

In general, the Gale evenness conditions allows for Gale strings that start
or end with an odd-length run; but if $d$ is even then $s$ can start with
an odd run if and only if it ends with an odd run.
We can then consider the Gale strings in $G(d,n)$ with even $d$ as a
the ``loops'' obtained by ``glueing together'' the extremes of the strings,
so that all runs on the loops are even.
Formally: we can see the indices of a Gale string $s\in G(d,n)$ with
$d$ even as equivalence classes modulo $n$, identifying $s(i+n)=s(i)$.
This also shows that the set of Gale strings of even dimension is invariant
under a cyclic shift of the strings.

\begin{example}\label{gs-example}
As an example of $d$ even, we have
\begin{align*}
G(4,6) = \{ & \1\1\1\100, \1\1\100\1, \1\100\1\1, \100\1\1\1, 00\1\1\1\1, \\
            & 0\1\1\1\10, \1\10\1\10, \10\1\10\1, 0\1\10\1\1 \}
\end{align*}

The strings $\1\1\1\100$, $\1\1\100\1$, $\1\100\1\1$, $\100\1\1\1$,
$00\1\1\1\1$ and $0\1\1\1\10$ are
equivalent under a cyclic shift (if considering the strings as ``loops'', the
$\1$'s are all consecutive), as are the strings $\1\10\1\10$, $\10\1\10\1$
and $0\1\10\1\1$ (if considering the strings as ``loops'', the even runs of
$\1$'s are two couples separated by a single $0$).

As an example for $d$ odd, we have
\[
G(3,5) = \{ \1\1\100, \10\1\10, \100\1\1, \1\100\1, 0\1\10\1, 00\1\1\1 \}
\]

Note how $0\10\1\1$ is a cyclic shift of $\10\1\10$, but it is not a Gale
string.
\end{example}

The relation between cyclic polytopes and Gale strings is given by the
following theorem by Gale \cite{gale}.

\begin{theorem}{\rm (Gale \cite{gale})}
\label{gale-thm}
For any positive integers $d,n$ with $n>d$\begin{align}
F \text{ is a} & \text{ facet of } C_d(n) \nonumber \\
& \Longleftrightarrow \nonumber \\
F = \conv\{ \mu(t_j)\ |\ s(j)=1 \text{ for }s\in G(d,n) \}.
\end{align}

\begin{proof}
We have that
$C_d(n) = %
\conv\{ \mu_d(\bar{t_j})\ |\ \bar{t_1} < \ldots < \bar{t_n} %
\text{ affinely independent} \}$.
We choose $t_1 < \ldots < t_d$ in the $\bar{t_j}$'s as above; then the
points $\mu_d(t_i)$ with $i\in [d]$ define an hyperplane $H$ that crosses
the moment curve $\mu_d(t)$ at all and only the $t_i$'s with $i\in [d]$.
The hyperplane $H$ is never tangent to the moment curve, and every crossing
gives a ``change of sign''; that is, if there is one and only one
$t_i\in (t,t')$ we have that $(\mu_d(t))(\mu_d(t')) < 0$.

A facet $F$ of the cyclic polytope $C_d(n)$ corresponds to a choice of
$t_i$'s with $i\in [d]$ such that for all the $\bar{t_k}$'s with $k\in [n]$
and $\bar{t_k}\notin \{ t_i\ |\ i\in [d] \}$ all the $\mu_d(\bar{t_k})$'s
have the same sign. This can happen only if the moment curve has an even
number of changes of sign, therefore of $t_i$'s, between two $\bar{t_k}$'s.
The $t_i$'s will correspond to the $\1$'s of the Gale string $s\in G(d,n)$
and the $\bar{t_k}$'s to the $0$'s, and the condition for being a facet
becomes the Gale evenness condition.
\end{proof}
\end{theorem}

Note also that the fact that the moment curve has exactly $d$ zeroes implies
that the each facet of $C_d(n)$ is a $d$-simplex, so $C_d(n)$ is simplicial;
furthermore, the choice of the $\bar{t_j}$'s in the proof is irrelevant.

\begin{example}
Consider the facet $F$ of the cyclic polytope $C_3(6)$ underlined in blue
in figure \ref{cyc36fac-fig}.

\begin{figure}[hbt]
\strut\hfill
\includegraphics[width=35ex]{chapter-1/fig/cyc36fac.pdf}%
\hfill\strut
\caption{%
A facet of the cyclic polytope $C_3(6)$.
}
\label{cyc36fac-fig}
\end{figure}

If we label the vertices on the moment curve as $i\in [n]$, and we set $i=1$
if $i$ is a vertex of $F$ and $i=0$ otherwise, we see that the corresponding
Gale string $s\in G(3,6)$ is $s=\100\1\10$.

On the hyperplane, the correspondence is as in figure \ref{cyc36fac-hyper-fig}.

\begin{figure}[hbt]
\strut\hfill
\includegraphics[width=45ex]{chapter-1/fig/100110-hyper.pdf}%
\hfill\strut
\caption[A facet of $C_3(6)$ as a Gale string in $G(3,6)$]{%
A facet of the cyclic polytope $C_3(6)$ and the corresponding Gale string
$s\in G(3,6)$.
}
\label{cyc36fac-hyper-fig}
\end{figure}
\end{example}


\begin{example}
\label{c46-ex}
Figure \ref{c46-fig} shows the cyclic polytope $C_4(6)$, with vertices
labeled according to the index $i\in [6]$ of the Gale string. The thin lines
represent edges inside the facet $1234$, drawn in bold lines, corresponding
to the Gale string $s=\1\1\1\100$.

\begin{figure}[hbt]
\strut\hfill
\includegraphics[width=60ex]{chapter-1/fig/c46.pdf}%
\hfill\strut
\caption{%
The cyclic polytope $C_4(6)$.
}
\label{c46-fig}
\end{figure}

On the hyperplane, the string $s=\1\1\1\100$ can be seen as in figure
\ref{c46fac-hyper-fig}.

\begin{figure}[hbt]
\strut\hfill
\includegraphics[width=45ex]{chapter-1/fig/111100-hyper.pdf}%
\hfill\strut
\caption{%
The Gale string $s=\1\1\1\100$.
}
\label{cyc36fac-fig}
\end{figure}
\end{example}


\begin{example}
As a counterexample, consider figure \ref{notfacet-even-hyper-fig}. The
corresponding bitstring would be $s=\1\1\10\10$, not a Gale string. The point
in pink and the point in green are on different sides of the hyperplane $H$,
so they do not belong to the same facet.

\begin{figure}[hbt]
\strut\hfill
\includegraphics[width=45ex]{chapter-1/fig/notfacet-even-hyper.pdf}%
\hfill\strut
\caption[Not a facet of $C_3(6)$]{%
The points on the moment curve have different signs, so they don't
correspond to a facet; the corresponding bitstring does not
satisfy the Gale evenness condition.
}
\label{notfacet-even-hyper-fig}
\end{figure}

Analogously for the string $s=\10\10\1$, corresponding to figure
\ref{notfacet-odd-hyper-fig}

\begin{figure}[hbt]
\strut\hfill
\includegraphics[width=45ex]{chapter-1/fig/notfacet-odd-hyper.pdf}%
\hfill\strut
\caption[Not a facet of $C_4(6)$]{%
The points on the moment curve don't correspond to a facet, and the
corresponding bitstring does not satisfy the Gale evenness condition.
}
\label{notfacet-odd-hyper-fig}
\end{figure}
\end{example}

We want now to exploit theorem \ref{gale-thm} to study bimatrix games;
more specifically, unit vector games. We have seen in proposition
\ref{2nash-to-aclf} that 2-{\sc Nash} can be reduced to
{\sc Another Completely Labeled Facet}. If the polytope $Q$
is cyclic and we define a labeling for Gale strings such that
a completely labeled Gale string corresponds to a completely labeled
facet of the polytope $Q$ in theorem  \ref{unit-vector-dual-thm},
we can study unit vector games with dual cyclic best
response polytope as Gale strings. Note that it takes polynomial
time to translate a cyclic polytope $C_d(n)$ into the corresponding
$G(d,n)$: the bitstrings of length $n$ with $d$ positive bits are found
in $O(n^2)$ time, and checking that a bitstring satisfies the Gale evenness
condition takes $O(d)$ time, so the operation takes $O(n^3d)$ time.

We say that $s\in G(d,n)$ is a {\em completely labeled Gale string} if
for some labeling function $l_s:[n]\to[d]$ the set
$\{ i\in [n]\ |\ s(i)=\1 \}$ is completely labeled by $l_s$.
Since $s\in G(d,n)$ has exacty $d$ bits equal to \1, this means that for
each $j\in [d]$ there is exactly one
$i\in [n]$ such that $s(i)=\1$ and $l_s(i)=j$.

Note that it is not always possible to find a completely labeled Gale string.

\begin{example}
\label{no-clgs}
For $l = 121314$, there are no completely labeled Gale strings.

The labels $l(i)=2,3,4$ appear only once in $l$, as $l(2),l(4),l(6)$
respectively; therefore we must have $s(2)=s(4)=s(6)=1$. For every other
$i\in [n]$ we have $l(i)=1$, so we have $l(i)=1$ for exactly one $i=1,3,5$.
The candidate strings are then \1\10\10\1, 0\1\1\10\1, 0\10\1\1\1; but
none of these satisfies the Gale evenness condition.
\end{example}

Let $(U,B)$, where $U=(e_{l(1),\ldots,e_{l(d)}})$ for some labeling
$l:[n]\to [d]$, be a unit vector game for which the dual of the best
response polytope is a cyclic polytope
$Q=\conv\{ e_1,\ldots,e_d,c_1,\ldots,c_n \}$. Theorem
\ref{unit-vector-dual-thm} gives a labeling $l_v$ of the $d+n$ vertices of
$Q$ as in \ref{vert-labeling-unitv}:
\begin{eqnarray*}
l_v(-e_i)=i\text{ for }i\in [m]; \\
l_v(c_j)=l(j)\text{ for }j\in [n].
\end{eqnarray*}
We define the labeling $l_s:[d+n]\to [d]$ as follows:
\begin{eqnarray}\label{gs-labeling-unitv}
l_s(i)=i\text{ for }i\in [d]; \nonumber \\
l_s(d+j)=l(j)\text{ for }j\in [n].
\end{eqnarray}
Then the Gale strings $s\in G(d,d+n)$ that are completely labeled for $l_s$
correspond exactly to the completely labeled facets of $Q$, with the
facet $F_0$ corresponding to the ``trivial'' completely labeled
string $\1^d 0$.

From this point forward, we will assume that $d$ is even.
We will also assume that the labeling $l:[n]\to [d]$ is such
that $l(i)\neq l(i+1)$; this can be done without loss of generality,
given the following consideration.
Suppose that $l(i)=l(i + 1)$ for some index $i$, and let $s$ be a
completely labeled Gale string for $l$. Then only one of
$s(i)$ and $s(i+1)$ can be equal to \1 (note that it's possible that both
are 0s). So $s(i)s(i+1)$ will never be a run of even length that
``interferes'' with the Gale Evenness Condition, so we can ``simplify''
by identifying the indices $i$ and $i + 1$.


\begin{example}
\label{c46-123432-ex}
Given the string of labels $l=123432$, there are four associated completely
labeled Gale strings in $G(4,6)$:
$s_A=\1\1\1\100$, $s_B=\1\10\1\10$, $s_C=\100\1\1\1$ and
$s_D=\10\1\10\1$.

\begin{tabular}{c | c @{ } c @{ } c @{ } c @{ } c @{ } c @{ } c }
{\small facet} & {\bf 1} & {\bf 2} & {\bf 3} & {\bf 4} & {\bf 3} & {\bf 2}\\
\hline
{\bf A} & \1 & \1 & \1 & \1 & \tdot & \tdot \\
{\bf B} & \1 & \1 & \tdot & \1 & \1 & \tdot \\
{\bf C} & \1 & \tdot & \tdot & \1 & \1 & \1 \\
{\bf D} & \1 & \tdot & \1 & \1 & \tdot & \1
\end{tabular}

In the cyclic polytope $C_4(6)$, these correspond to the facets as in figure
\ref{c46-123432-fig}.

\begin{figure}[hbt]
\strut\hfill
\includegraphics[width=60ex]{chapter-1/fig/123432-fac-name.pdf}%
\hfill\strut
\caption[Completely labeled facets of $C_4(6)$]{%
The cyclic polytope $C_4(6)$; the vertices are labeled following
the labeling $l_s=123432$. The completely labeled facets correspond to the
completely labeled Gale strings.
}
\label{c46-123432-fig}
\end{figure}
\end{example}

We can now define the problem \anothergale\ as follows:

\begin{fctproblem}
{\anothergale}
{A labeling $l:[n]\to[d]$, where $d$ is even and $d<n$.
A Gale string $s\in G(d,n)$, completely labeled by $l$.}
{A Gale string $s'\in G(d,n)$, completely labeled by $l$,
such that $s' \neq s$.}
\end{fctproblem}

Note that building the labeling $l_s$ from the labeling $l_v$ takes
polynomial time: for the labels $i\in [m]$ it is immediate, for the following
$n-m$ labels we have to check the labeling $l:[n]\to [m]$, that is,
the $n\times m$ unit matrix of the imitation game. Therefore, we have a
reduction from 2-{\sc Nash} to \anothergale.

\begin{proposition}
\label{2nash-to-another-gale}
The problem 2-{\sc Nash} is polynomial-time reducible to the problem
\anothergale.
\end{proposition}
